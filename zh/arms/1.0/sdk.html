<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SDK | FEE开源项目文档</title>
    <meta name="description" content="贝壳前端架构组项目开源文档（中文）">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/FEE-doc/assets/css/0.styles.c67ff556.css" as="style"><link rel="preload" href="/FEE-doc/assets/js/app.ea892fa5.js" as="script"><link rel="preload" href="/FEE-doc/assets/js/2.ead826cc.js" as="script"><link rel="preload" href="/FEE-doc/assets/js/13.de61ed3a.js" as="script"><link rel="prefetch" href="/FEE-doc/assets/js/10.f467d413.js"><link rel="prefetch" href="/FEE-doc/assets/js/11.68ab6506.js"><link rel="prefetch" href="/FEE-doc/assets/js/12.2a20420b.js"><link rel="prefetch" href="/FEE-doc/assets/js/14.672bf7b2.js"><link rel="prefetch" href="/FEE-doc/assets/js/15.b680974d.js"><link rel="prefetch" href="/FEE-doc/assets/js/16.17802682.js"><link rel="prefetch" href="/FEE-doc/assets/js/17.93d35457.js"><link rel="prefetch" href="/FEE-doc/assets/js/18.fe060def.js"><link rel="prefetch" href="/FEE-doc/assets/js/19.03657e86.js"><link rel="prefetch" href="/FEE-doc/assets/js/20.42941d90.js"><link rel="prefetch" href="/FEE-doc/assets/js/21.416970b9.js"><link rel="prefetch" href="/FEE-doc/assets/js/3.8d87c35c.js"><link rel="prefetch" href="/FEE-doc/assets/js/4.a50e9400.js"><link rel="prefetch" href="/FEE-doc/assets/js/5.99243804.js"><link rel="prefetch" href="/FEE-doc/assets/js/6.51eeb66a.js"><link rel="prefetch" href="/FEE-doc/assets/js/7.8dd743ae.js"><link rel="prefetch" href="/FEE-doc/assets/js/8.6cc17035.js"><link rel="prefetch" href="/FEE-doc/assets/js/9.816399d4.js">
    <link rel="stylesheet" href="/FEE-doc/assets/css/0.styles.c67ff556.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/FEE-doc/zh/" class="home-link router-link-active"><img src="/FEE-doc/images/icons/logo.png" alt="FEE开源项目文档" class="logo"> <span class="site-name can-hide">FEE开源项目文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="灯塔系统" class="dropdown-title"><span class="title">灯塔系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/FEE-doc/zh/arms/1.0/" class="nav-link router-link-active">
  V1.x
</a></li></ul></div></div> <a href="https://github.com/aa978563552/FEE-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="灯塔系统" class="dropdown-title"><span class="title">灯塔系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/FEE-doc/zh/arms/1.0/" class="nav-link router-link-active">
  V1.x
</a></li></ul></div></div> <a href="https://github.com/aa978563552/FEE-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/FEE-doc/zh/arms/1.0/" class="sidebar-link">灯塔 V1.0</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>组成</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/FEE-doc/zh/arms/1.0/client.html" class="sidebar-link">Client端</a></li><li><a href="/FEE-doc/zh/arms/1.0/server.html" class="sidebar-link">Server端</a></li><li><a href="/FEE-doc/zh/arms/1.0/sdk.html" class="active sidebar-link">SDK</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/FEE-doc/zh/arms/1.0/sdk.html#发版check-list" class="sidebar-link">发版Check List</a></li><li class="sidebar-sub-header"><a href="/FEE-doc/zh/arms/1.0/sdk.html#安装与使用" class="sidebar-link">安装与使用</a></li><li class="sidebar-sub-header"><a href="/FEE-doc/zh/arms/1.0/sdk.html#自动错误监控使用说明" class="sidebar-link">自动错误监控使用说明</a></li><li class="sidebar-sub-header"><a href="/FEE-doc/zh/arms/1.0/sdk.html#主动打点方法说明" class="sidebar-link">主动打点方法说明</a></li><li class="sidebar-sub-header"><a href="/FEE-doc/zh/arms/1.0/sdk.html#如何确认埋点成功？" class="sidebar-link">如何确认埋点成功？</a></li><li class="sidebar-sub-header"><a href="/FEE-doc/zh/arms/1.0/sdk.html#数据更新周期" class="sidebar-link">数据更新周期</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="发版check-list"><a href="#发版check-list" class="header-anchor">#</a> 发版Check List</h2> <ul><li>[ ] 目前有两处修改版本号的地方, config/index.js &amp; package.json, 两处版本号是否统一</li></ul> <h2 id="安装与使用"><a href="#安装与使用" class="header-anchor">#</a> 安装与使用</h2> <p>使用项目中自带的SDK包，引入进行打点</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> dt <span class="token keyword">from</span> <span class="token string">'sdk'</span><span class="token punctuation">;</span>

<span class="token comment">// 初始化配置</span>
dt<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  pid<span class="token operator">:</span> <span class="token string">'project_id'</span><span class="token punctuation">,</span> <span class="token comment">// [必填]项目id, 由灯塔项目组统一分配</span>
  uuid<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// [可选]设备唯一id, 用于计算uv数&amp;设备分布. 一般在cookie中可以取到, 没有uuid可用设备mac/idfa/imei替代. 或者在storage的key中存入随机数字, 模拟设备唯一id.</span>
  ucid<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// [可选]用户ucid, 用于发生异常时追踪用户信息, 一般在cookie中可以取到, 没有可传空字符串</span>

 record<span class="token operator">:</span> <span class="token punctuation">{</span>
    time_on_page<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否监控用户在线时长数据, 默认为true</span>
    performance<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否监控页面载入性能, 默认为true</span>
    js_error<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//  是否监控页面报错信息, 默认为true</span>
    <span class="token comment">// 配置需要监控的页面报错类别, 仅在js_error为true时生效, 默认均为true(可以将配置改为false, 以屏蔽不需要上报的错误类别)</span>
    js_error_report_config<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token constant">ERROR_RUNTIME</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// js运行时报错</span>
      <span class="token constant">ERROR_SCRIPT</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// js资源加载失败</span>
      <span class="token constant">ERROR_STYLE</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// css资源加载失败</span>
      <span class="token constant">ERROR_IMAGE</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 图片资源加载失败</span>
      <span class="token constant">ERROR_AUDIO</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 音频资源加载失败</span>
      <span class="token constant">ERROR_VIDEO</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 视频资源加载失败</span>
      <span class="token constant">ERROR_CONSOLE</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// vue运行时报错</span>
      <span class="token constant">ERROR_TRY_CATCH</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 未catch错误</span>
      <span class="token comment">// 自定义检测函数, 上报前最后判断是否需要报告该错误</span>
      <span class="token comment">// 回调函数说明</span>
      <span class="token comment">// 传入参数 =&gt; </span>
      <span class="token comment">//            desc:  字符串, 错误描述</span>
      <span class="token comment">//            stack: 字符串, 错误堆栈信息</span>
      <span class="token comment">// 返回值 =&gt;  </span>
      <span class="token comment">//            true  : 上报打点请求</span>
      <span class="token comment">//            false : 不需要上报</span>
      <span class="token function-variable function">checkErrrorNeedReport</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">desc<span class="token punctuation">,</span> stack</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 业务方的js版本号, 会随着打点数据一起上传, 方便区分数据来源</span>
  <span class="token comment">// 可以不填, 默认为1.0.0</span>
  version<span class="token operator">:</span> <span class="token string">'1.0.0'</span><span class="token punctuation">,</span>

  <span class="token comment">// 对于如同</span>
  <span class="token comment">// test.com/detail/1.html</span>
  <span class="token comment">// test.com/detail/2.html</span>
  <span class="token comment">// test.com/detail/3.html</span>
  <span class="token comment">// ...</span>
  <span class="token comment">// 这种页面来说, 虽然url不同, 但他们本质上是同一个页面</span>
  <span class="token comment">// 因此需要业务方传入一个处理函数, 根据当前url解析出真实的页面类型(例如: 二手房列表/经纪人详情页), 以便灯塔系统对错误来源进行分类</span>
  <span class="token comment">// 回调函数说明</span>
  <span class="token comment">// 传入参数 =&gt; window.location</span>
  <span class="token comment">// 返回值 =&gt; 对应的的页面类型(50字以内, 建议返回汉字, 方便查看), 默认是返回当前页面的url</span>
  <span class="token function-variable function">getPageType</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">location</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>location<span class="token punctuation">.</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>location<span class="token punctuation">.</span>pathname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>script标签引入 =&gt;</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  window<span class="token punctuation">.</span>dt <span class="token operator">&amp;&amp;</span> dt<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    pid<span class="token operator">:</span> <span class="token string">'project_id'</span><span class="token punctuation">,</span> <span class="token comment">// [必填]项目id, 由灯塔项目组统一分配</span>
    uuid<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// [可选]设备唯一id, 用于计算uv数&amp;设备分布. 一般在cookie中可以取到, 没有uuid可用设备mac/idfa/imei替代. 或者在storage的key中存入随机数字, 模拟设备唯一id.</span>
    ucid<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// [可选]用户ucid, 用于发生异常时追踪用户信息, 一般在cookie中可以取到, 没有可传空字符串</span>

    is_test<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否为测试数据, 默认为false(测试模式下打点数据仅供浏览, 不会展示在系统中)</span>
    record<span class="token operator">:</span> <span class="token punctuation">{</span>
      time_on_page<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否监控用户在线时长数据, 默认为true</span>
      performance<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否监控页面载入性能, 默认为true</span>
      js_error<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//  是否监控页面报错信息, 默认为true</span>
      <span class="token comment">// 配置需要监控的页面报错类别, 仅在js_error为true时生效, 默认均为true(可以将配置改为false, 以屏蔽不需要上报的错误类别)</span>
      js_error_report_config<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token constant">ERROR_RUNTIME</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// js运行时报错</span>
        <span class="token constant">ERROR_SCRIPT</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// js资源加载失败</span>
        <span class="token constant">ERROR_STYLE</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// css资源加载失败</span>
        <span class="token constant">ERROR_IMAGE</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 图片资源加载失败</span>
        <span class="token constant">ERROR_AUDIO</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 音频资源加载失败</span>
        <span class="token constant">ERROR_VIDEO</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 视频资源加载失败</span>
        <span class="token constant">ERROR_CONSOLE</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// vue运行时报错</span>
        <span class="token constant">ERROR_TRY_CATCH</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 未catch错误</span>
        <span class="token comment">// 自定义检测函数, 上报前最后判断是否需要报告该错误</span>
        <span class="token comment">// 回调函数说明</span>
        <span class="token comment">// 传入参数 =&gt; </span>
        <span class="token comment">//            desc:  字符串, 错误描述</span>
        <span class="token comment">//            stack: 字符串, 错误堆栈信息</span>
        <span class="token comment">// 返回值 =&gt;  </span>
        <span class="token comment">//            true  : 上报打点请求</span>
        <span class="token comment">//            false : 不需要上报</span>
        <span class="token function-variable function">checkErrrorNeedReport</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">desc<span class="token punctuation">,</span> stack</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 业务方的js版本号, 会随着打点数据一起上传, 方便区分数据来源</span>
    <span class="token comment">// 可以不填, 默认为1.0.0</span>
    version<span class="token operator">:</span> <span class="token string">'1.0.0'</span><span class="token punctuation">,</span>

    <span class="token comment">// 对于如同</span>
    <span class="token comment">// test.com/detail/1.html</span>
    <span class="token comment">// test.com/detail/2.html</span>
    <span class="token comment">// test.com/detail/3.html</span>
    <span class="token comment">// ...</span>
    <span class="token comment">// 这种页面来说, 虽然url不同, 但他们本质上是同一个页面</span>
    <span class="token comment">// 因此需要业务方传入一个处理函数, 根据当前url解析出真实的页面类型(例如: 二手房列表/经纪人详情页), 以便灯塔系统对错误来源进行分类</span>
    <span class="token comment">// 回调函数说明</span>
    <span class="token comment">// 传入参数 =&gt; window.location</span>
    <span class="token comment">// 返回值 =&gt; 对应的的页面类型(50字以内, 建议返回汉字, 方便查看), 默认是返回当前页面的url</span>
    <span class="token function-variable function">getPageType</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">location</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>location<span class="token punctuation">.</span>host<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>location<span class="token punctuation">.</span>pathname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><h2 id="自动错误监控使用说明"><a href="#自动错误监控使用说明" class="header-anchor">#</a> 自动错误监控使用说明</h2> <p>浏览器中对脚本报错信息有跨域限制, 通过标签引入js时, 需要在所有要监控的script标签中添加 <code>crossorigin=&quot;anonymous&quot;</code> 属性后, 才能获取到错误堆栈数据, 否则只能看到<code>Script error</code>的提示</p> <p>参考: <a href="https://blog.fundebug.com/2017/04/07/solve-script-error/" target="_blank" rel="noopener noreferrer">FunDebug: Script error.解决方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="主动打点方法说明"><a href="#主动打点方法说明" class="header-anchor">#</a> 主动打点方法说明</h2> <h3 id="产品指标"><a href="#产品指标" class="header-anchor">#</a> 产品指标</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 用户点击行为上报，用于统计菜单点击量
 * @param {String}  clickBehavior [必填]用户行为标识符, 用于统计菜单点击量 , 最多50字符( menu/click/button/...)
 * @param {String} name [必填]用户行为名称, 和clickBehavior对应, 用于展示, 建议传中文, 最多50字符
 * @param {String} url  [可选]用户点击页面url, 可以作为辅助信息, 最多200字符
 */</span>
dt<span class="token punctuation">.</span><span class="token function">behavior</span><span class="token punctuation">(</span>clickBehaviorType<span class="token punctuation">,</span> name<span class="token punctuation">,</span> url<span class="token punctuation">)</span>

<span class="token comment">//demo:</span>
dt<span class="token punctuation">.</span><span class="token function">behavior</span><span class="token punctuation">(</span>
<span class="token string">'/abnormal_monitor/error_dashboard'</span><span class="token punctuation">,</span>
<span class="token string">'灯塔-页面性能'</span><span class="token punctuation">,</span>
window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href
<span class="token punctuation">)</span>


<span class="token comment">/**
 * JS错误主动上报接口
 * @param {String} errorName 错误类型, 推荐格式 =&gt; &quot;错误类型(中文)_${具体错误名}&quot;, 最长200字
 * @param {String} url       错误对应的url,  location.host + location.pathname, 不包括get参数(get参数可以转成json后放在detail中), 最长200个字
 * @param {Object} extraInfo 附属信息, 默认为空对象
 *                 =&gt; extraInfo 中以下字段填写后可以在后台错误日志列表中直接展示
 *                 =&gt;        trace_url         // [String]请求对应的trace系统查看地址, 例如: trace系统url + trace_id
 *                 =&gt;        http_code         // [Number]接口响应的Http状态码，
 *                 =&gt;        during_ms         // [Number]接口响应时长(毫秒)
 *                 =&gt;        request_size_b    // [Number]post参数体积, 单位b
 *                 =&gt;        response_size_b   // [Number]响应值体积, 单位b
 *                 =&gt; 其余字段会作为补充信息进行展示
 */</span>
<span class="token keyword">function</span> <span class="token function">notify</span> <span class="token punctuation">(</span>errorName <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> url <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> extraInfo <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> 

<span class="token comment">// demo：</span>
dt<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span>
  <span class="token string">'response code'</span><span class="token punctuation">,</span>         <span class="token comment">// 错误名, 不能超过200个字符</span>
  <span class="token string">'a.b.com'</span><span class="token punctuation">,</span>               <span class="token comment">// url地址, 不能超过200个字符</span>
  <span class="token punctuation">{</span>
   <span class="token comment">// 下列字段填写后会被统一展示 </span>
   <span class="token string">'trace_url'</span><span class="token operator">:</span><span class="token string">'trace.test.com/123456'</span><span class="token punctuation">,</span>
   <span class="token string">'http_code'</span><span class="token operator">:</span><span class="token number">200</span><span class="token punctuation">,</span>        
   <span class="token string">'during_ms'</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span>         
   <span class="token string">'request_size_b'</span><span class="token operator">:</span><span class="token number">1024</span><span class="token punctuation">,</span>  
   <span class="token string">'response_size_b'</span><span class="token operator">:</span><span class="token number">1024</span><span class="token punctuation">,</span> 
   
   <span class="token comment">// 以下字段作为补充说明进行展示</span>
   <span class="token operator">...</span> <span class="token comment">// 任意 key =&gt; value</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h2 id="如何确认埋点成功？"><a href="#如何确认埋点成功？" class="header-anchor">#</a> 如何确认埋点成功？</h2> <p>通过Chrome或Charles等工具拦截URL为<code>https://dig.xtest.com/fee.gif</code>开头的网络请求,查看请求参数是否携带埋点信息</p> <p>例如这个URL:
<a href="https://dig.xxtest.com/fee.gif?d=%7B%22type%22%3A%22error%22%2C%22code%22%3A3%2C%22detail%22%3A%7B%22error_no%22%3A122%2C%22http_code%22%3A%22%22%2C%22during_ms%22%3A%22%22%2C%22url%22%3A%22a.b.c%22%2C%22request_size_b%22%3A%22%22%2C%22response_size_b%22%3A%22%22%2C%22reason%22%3A%22ERR_BLOCKED_BY_CLIENT%22%7D%2C%22extra%22%3A%7B%7D%2C%22common%22%3A%7B%22pid%22%3A%22platfe_saas%22%2C%22uuid%22%3A%22f770330d-b2c7-4bfa-94fb-b31338f65a85%22%2C%22ssid%22%3A%22df9c0245-005d-479c-81e0-7daa94c0681d%22%2C%22ucid%22%3A1000000023100106%2C%22timestamp%22%3A1537431733127%7D%2C%22msg%22%3A%22%22%7D" target="_blank" rel="noopener noreferrer">点我<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>对应打点信息为</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code>d<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token property">&quot;detail&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;error_no&quot;</span><span class="token operator">:</span> <span class="token number">122</span><span class="token punctuation">,</span>
    <span class="token property">&quot;http_code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;during_ms&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;url&quot;</span><span class="token operator">:</span> <span class="token string">&quot;a.b.c&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;request_size_b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;response_size_b&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;reason&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ERR_BLOCKED_BY_CLIENT&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;extra&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;common&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;platfe&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;uuid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;f770330d-b2c7-4bfa-94fb-b31338f65a85&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ssid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;df9c0245-005d-479c-81e0-7daa94c0681d&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;ucid&quot;</span><span class="token operator">:</span> <span class="token number">1000000023100106</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token number">1537431733127</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="数据更新周期"><a href="#数据更新周期" class="header-anchor">#</a> 数据更新周期</h2> <table><thead><th>数据项</th> <th>更新周期</th></thead> <tbody><tr><td>页面异常</td> <td>5分钟</td></tr> <tr><td>页面性能指标</td> <td>15分钟</td></tr> <tr><td>用户停留时长</td> <td>15分钟</td></tr> <tr><td>新用户数</td> <td>1小时</td></tr> <tr><td>设备数据</td> <td>1小时</td></tr> <tr><td>新用户数</td> <td>1小时</td></tr> <tr><td>终端:操作系统分布</td> <td>6小时</td></tr> <tr><td>终端:设备分布</td> <td>6小时</td></tr> <tr><td>终端:浏览器分布</td> <td>6小时</td></tr></tbody></table></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/aa978563552/FEE-doc/edit/master/zh/arms/1.0/sdk.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次编辑时间:</span> <span class="time">2020-4-10 16:09:39</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/FEE-doc/zh/arms/1.0/server.html" class="prev">
        Server端
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/FEE-doc/assets/js/app.ea892fa5.js" defer></script><script src="/FEE-doc/assets/js/2.ead826cc.js" defer></script><script src="/FEE-doc/assets/js/13.de61ed3a.js" defer></script>
  </body>
</html>
